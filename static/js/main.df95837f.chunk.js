(this.webpackJsonptasks=this.webpackJsonptasks||[]).push([[0],{212:function(e,n,t){},213:function(e,n,t){"use strict";t.r(n);var a=t(16),r=t(43),i=t(0),c=t.n(i),o=t(75),s=t(219),d=t(221),l=t(109),u=t(222),p=t(95),j=t(3),h=function(e){var n,t,a,r,i=(n=e.onTaskChanged,t=e.onDependenciesChanged,function(){n([]),t([])}),c=(a=e.tasks,r=e.dependencies,function(){var e={tasks:a,dependencies:r},n=new Blob([JSON.stringify(e,void 0,2)],{type:"text/json;charset=utf-8"});Object(p.saveAs)(n,"data.json")}),h=function(e,n){return function(t){return new Promise((function(a){var r=new FileReader;r.readAsText(t),r.onload=function(){if(r.result){var t=JSON.parse(r.result.toString());e(t.tasks),n(t.dependencies)}},a(void 0)}))}}(e.onTaskChanged,e.onDependenciesChanged);return Object(j.jsx)(j.Fragment,{children:Object(j.jsxs)("div",{className:"header-container",children:[Object(j.jsx)("div",{className:"header-left",children:Object(j.jsx)("h3",{children:"\u4f01\u4f01\u56db\u5b63\u5ea6\u76ee\u6807\u4f9d\u8d56\u5173\u7cfb"})}),Object(j.jsxs)("div",{className:"header-right",children:[Object(j.jsx)(o.a,{icon:Object(j.jsx)(d.a,{}),shape:"circle",onClick:function(){return i()}}),Object(j.jsx)(o.a,{type:"primary",icon:Object(j.jsx)(l.a,{}),shape:"circle",onClick:function(){return c()}}),Object(j.jsx)(s.a,{beforeUpload:h,showUploadList:!1,children:Object(j.jsx)(o.a,{type:"primary",icon:Object(j.jsx)(u.a,{}),shape:"circle"})})]})]})})};var f,g,b=t(17),m=t(223);function v(e){var n=Object(i.useState)(),t=Object(r.a)(n,2),a=t[0],c=t[1],o=function(){var e=[];return null===a||void 0===a||a.forEachNode((function(n){e.push(n.data)})),e};return{data:e.data,onGridReady:function(e){c(e.api)},onRowDataUpdated:function(n){var t=o();e.onDataChanged(t),console.log("row data changed",t)},onCellValueChanged:function(){var n=o();console.log("rowData is",n),e.onDataChanged(n)},create:function(){null===a||void 0===a||a.applyTransaction({add:[{id:Date.now()}]});null===a||void 0===a||a.ensureIndexVisible(e.data.length)},remove:function(){var e=null===a||void 0===a?void 0:a.getSelectedRows();if(console.log("selectedData",e),null===e||void 0===e?void 0:e.length)null===a||void 0===a||a.applyTransaction({remove:e})}}}!function(e){e.Goal="\u76ee\u6807",e.Solution="\u65b9\u6848",e.TechnicalSupport="\u6280\u672f\u652f\u6491",e.Refactory="\u91cd\u6784",e.Action="\u52a8\u4f5c",e.Task="\u4efb\u52a1\u9879"}(f||(f={})),function(e){e.Dependent="Dependent",e.Related="Related"}(g||(g={}));var O=c.a.memo((function(e){var n=v(e),t=n.data,a=n.onGridReady,r=n.onRowDataUpdated,i=n.onCellValueChanged,c=n.create,s=n.remove;return Object(j.jsxs)("div",{className:"task-list",children:[Object(j.jsxs)("div",{className:"grid-header",children:[Object(j.jsx)(o.a,{type:"primary",icon:Object(j.jsx)(m.a,{}),shape:"circle",onClick:function(){return c()}}),Object(j.jsx)(o.a,{type:"default",icon:Object(j.jsx)(d.a,{}),shape:"round",onClick:function(){return s()},children:"\u9009\u4e2d"})]}),Object(j.jsxs)(b.AgGridReact,{className:"grid",getRowNodeId:function(e){return e.id},rowData:t,rowSelection:"single",suppressScrollOnNewData:!0,onGridReady:a,onRowDataUpdated:r,onCellValueChanged:i,children:[Object(j.jsx)(b.AgGridColumn,{field:"displayInCharts",headerName:"\u663e\u793a",width:50,resizable:!0,cellRendererFramework:function(e){return Object(j.jsx)("input",{type:"checkbox",checked:e.value,onChange:function(n){e.setValue(n.target.checked)}})}}),Object(j.jsx)(b.AgGridColumn,{field:"id",headerName:"ID",width:200,editable:!0,resizable:!0,cellEditor:"agTextCellEditor"}),Object(j.jsx)(b.AgGridColumn,{field:"name",headerName:"\u4efb\u52a1\u540d\u79f0",width:200,editable:!0,resizable:!0,cellEditor:"agTextCellEditor"}),Object(j.jsx)(b.AgGridColumn,{field:"category",headerName:"\u7c7b\u578b",width:100,editable:!0,resizable:!0,cellEditor:"agPopupSelectCellEditor",cellEditorParams:{values:Object.values(f)}}),Object(j.jsx)(b.AgGridColumn,{field:"descriptions",headerName:"\u63cf\u8ff0",flex:1,width:200,minWidth:200,editable:!0,resizable:!0,cellEditor:"agLargeTextCellEditor"})]})]})}));var k=function(e){var n=v(e),t=n.data,a=n.onGridReady,r=n.onRowDataUpdated,i=n.onCellValueChanged,c=n.create,s=n.remove,l=e.tasks.map((function(e){return e.id})),u=Object.values(g),p={valueGetter:function(e){if(e.data.descriptions)return e.data.descriptions.join("\n")},valueSetter:function(e){return e.data.descriptions=e.newValue.split("\n"),!0}},h=p.valueGetter,f=p.valueSetter;return Object(j.jsxs)("div",{className:"task-dependencies",children:[Object(j.jsxs)("div",{className:"grid-header",children:[Object(j.jsx)(o.a,{type:"primary",icon:Object(j.jsx)(m.a,{}),shape:"circle",onClick:function(){return c()}}),Object(j.jsx)(o.a,{type:"default",icon:Object(j.jsx)(d.a,{}),shape:"round",onClick:function(){return s()},children:"\u9009\u4e2d"})]}),Object(j.jsxs)(b.AgGridReact,{className:"grid",getRowNodeId:function(e){return"".concat(e.src,"_").concat(e.target)},rowData:t,rowSelection:"single",suppressScrollOnNewData:!0,onGridReady:a,onRowDataUpdated:r,onCellValueChanged:i,children:[Object(j.jsx)(b.AgGridColumn,{field:"displayInCharts",headerName:"\u663e\u793a",width:50,resizable:!0,cellRendererFramework:function(e){return Object(j.jsx)("input",{type:"checkbox",checked:e.value,onChange:function(n){e.setValue(n.target.checked)}})}}),Object(j.jsx)(b.AgGridColumn,{field:"src",headerName:"\u6e90\u4efb\u52a1ID",width:200,editable:!0,cellEditor:"agPopupSelectCellEditor",cellEditorParams:{values:l}}),Object(j.jsx)(b.AgGridColumn,{field:"target",headerName:"\u76ee\u6807\u4efb\u52a1ID",width:200,editable:!0,cellEditor:"agPopupSelectCellEditor",cellEditorParams:{values:l}}),Object(j.jsx)(b.AgGridColumn,{field:"type",headerName:"\u5173\u7cfb",width:150,editable:!0,cellEditor:"agPopupSelectCellEditor",cellEditorParams:{values:u}}),Object(j.jsx)(b.AgGridColumn,{field:"descriptions",headerName:"\u63cf\u8ff0",flex:1,width:200,minWidth:200,editable:!0,cellEditor:"agLargeTextCellEditor",valueGetter:h,valueSetter:f})]})]})};var y,x=function(e){return Object(j.jsxs)("div",{className:"tasks ag-theme-alpine",children:[Object(j.jsx)(O,{data:e.tasks,onDataChanged:e.onTaskChanged}),Object(j.jsx)(k,{tasks:e.tasks,data:e.dependencies,onTaskChanged:e.onTaskChanged,onDataChanged:e.onDependenciesChanged})]})},C=t(36),D=t(61);!function(e){e.ForceRelation="ForceRelation",e.Sankey="Sankey"}(y||(y={}));t(44),f.TechnicalSupport,f.Refactory,f.Goal,g.Dependent,g.Dependent,g.Dependent,g.Dependent,g.Dependent,f.Solution,f.Task,f.Task,f.Task,g.Dependent,g.Dependent,g.Dependent,g.Dependent,f.Solution,f.Solution,f.TechnicalSupport,f.Task,f.Task,g.Dependent,g.Dependent,g.Dependent,f.Goal,f.Solution,f.Task,f.Task,f.Task,f.TechnicalSupport,g.Dependent,g.Dependent,g.Related,g.Dependent,g.Dependent,g.Dependent,f.Goal,f.Solution,f.Task,f.Task,g.Dependent,g.Dependent,g.Dependent,f.Refactory,f.Refactory,f.Refactory,f.Action,g.Related,g.Related,g.Related,g.Related,f.Action,g.Related,g.Related,g.Related;var S=t(64),w=t(38),R=t(26),N=[{name:"\u76ee\u6807",symbolSize:50,itemStyle:{}},{name:"\u65b9\u6848",symbolSize:40},{name:"\u6280\u672f\u652f\u6491",symbolSize:30},{name:"\u91cd\u6784",symbolSize:40},{name:"\u52a8\u4f5c",symbolSize:20,symbol:"diamond",itemStyle:{}},{name:"\u4efb\u52a1\u9879",symbolSize:20}],T=["name"];function E(e,n){var t=n.tasks,a=n.dependencies;return t.forEach((function(n){var t=n.id,a=n.name,r=n.category;e.nodes.push({id:t,name:"".concat(a,"\n\uff08").concat(t,"\uff09"),category:r})})),a.forEach((function(n){var t=n.src,a=n.target,r=n.type,i=n.descriptions,c=void 0===i?[]:i,o=function(e){return e===g.Related?["none","none"]:["arrow","none"]}(r);e.links.push({source:t,target:a,symbol:o});var s="".concat(t,"-").concat(a);e.description[s]=c.join("<br />")})),e}function G(e){var n=e.nodes,t=e.links,a=e.categories,r=e.description,i=function(e){return e.reduce((function(e,n){return Object(R.a)(Object(R.a)({},e),{},Object(w.a)({},n.name,n))}),{})}(a);return{nodes:n.map((function(e){if(e.category&&i[e.category]){var n=i[e.category],t=(n.name,Object(S.a)(n,T));return Object(R.a)(Object(R.a)({},e),t)}return e})),links:t,categories:a,description:r}}function A(){return{nodes:[],links:[],categories:N,description:{}}}function I(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];var a=n.reduce((function(e,n){return E(e,n)}),A());return G(a)}var z=["name"];function F(e,n){var t=n.tasks,a=n.dependencies;return t.forEach((function(n){var t=n.id,a=n.name,r=n.category;e.nodes.push({id:t,name:"".concat(a,"\r\n(").concat(t,")"),category:r})})),a.forEach((function(n){var t=n.src,a=n.target,r=n.descriptions,i=void 0===r?[]:r;e.links.push({source:a,target:t,value:1});var c="".concat(a,"-").concat(t);e.description[c]=i.join("<br />")})),e}function P(e){var n=e.nodes,t=e.links,a=e.categories,r=e.description,i=function(e){return e.reduce((function(e,n){return Object(R.a)(Object(R.a)({},e),{},Object(w.a)({},n.name,n))}),{})}(a);return{nodes:n.map((function(e){if(e.category&&i[e.category]){var n=i[e.category],t=(n.name,Object(S.a)(n,z));return Object(R.a)(Object(R.a)({},e),t)}return e})),links:t,categories:a,description:r}}function U(){return{nodes:[],links:[],categories:N,description:{}}}function V(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];var a=n.reduce((function(e,n){return F(e,n)}),U());return P(a)}function J(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),a=1;a<n;a++)t[a-1]=arguments[a];switch(e){case y.ForceRelation:return I.apply(void 0,t);case y.Sankey:return V.apply(void 0,t)}}function L(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),a=1;a<n;a++)t[a-1]=arguments[a];return J.apply(void 0,[e].concat(t))}function q(e,n){return e===y.Sankey?function(e){var n=L(y.Sankey,e);return{tooltip:{},legend:[{orient:"vertical",x:"right",y:"middle",top:"0%",data:n.categories.map((function(e){return e.name}))}],animation:!1,animationDuration:1500,animationEasingUpdate:"quinticInOut",series:[{type:"sankey",data:n.nodes,links:n.links,emphasis:{focus:"adjacency"},label:{position:"top",show:!0,normal:{formatter:function(e){return e.name}}},tooltip:{formatter:function(e){var t="".concat(e.data.source,"-").concat(e.data.target);return n.description[t]}},lineStyle:{color:"source",curveness:.3}}]}}(n):function(e){var n=L(y.ForceRelation,e);return console.log("forceRelation",n),{tooltip:{},legend:[{orient:"vertical",x:"right",y:"middle",top:"0%",data:n.categories.map((function(e){return e.name}))}],animation:!1,animationDuration:1500,animationEasingUpdate:"quinticInOut",series:[{type:"graph",layout:"force",data:n.nodes,links:n.links,categories:n.categories,force:{repulsion:500,gravity:.1,layoutAnimation:!1,edgeLength:100},animationDuration:1500,animationEasingUpdate:"quinticInOut",roam:!0,symbolSize:20,focusNodeAdjacency:!0,label:{position:"top",show:!0},lineStyle:{color:"#888",curveness:.3},emphasis:{lineStyle:{width:10}},tooltip:{formatter:function(e){var t="".concat(e.data.source,"-").concat(e.data.target);return n.description[t]}}}]}}(n)}var B=function(e){var n=q(y.ForceRelation,e);return Object(j.jsx)(D.a,{option:n,className:"chart-item"})},W=function(e){var n=q(y.Sankey,e);return Object(j.jsx)(D.a,{option:n,className:"chart-item"})},_=function(e){return Object(j.jsxs)(C.d,{forceRenderTabPanel:!0,children:[Object(j.jsxs)(C.b,{children:[Object(j.jsx)(C.a,{children:"\u5173\u7cfb\u56fe"}),Object(j.jsx)(C.a,{children:"\u6267\u884c\u987a\u5e8f\u56fe"})]}),Object(j.jsx)(C.c,{children:Object(j.jsx)(B,{tasks:e.tasks,dependencies:e.dependencies})}),Object(j.jsx)(C.c,{children:Object(j.jsx)(W,{tasks:e.tasks,dependencies:e.dependencies})})]})};function H(){var e=function(){var e=Object(i.useState)([]),n=Object(r.a)(e,2),t=n[0],a=n[1],c=Object(i.useState)([]),o=Object(r.a)(c,2);return{tasks:t,onTaskChanged:a,dependencies:o[0],onDependenciesChanged:o[1]}}(),n=e.tasks,t=e.onTaskChanged,a=e.dependencies,c=e.onDependenciesChanged,o=n.filter((function(e){return e.displayInCharts})),s=a.filter((function(e){return e.displayInCharts}));return{tasks:n,tasksInChart:o,dependencies:a,dependenciesInChart:s,actions:{onTaskChanged:t,onDependenciesChanged:c}}}var K=function(){var e=H(),n=e.tasks,t=e.tasksInChart,a=e.dependencies,r=e.dependenciesInChart,i=e.actions,c=i.onTaskChanged,o=i.onDependenciesChanged;return console.log("app render",n),Object(j.jsx)(j.Fragment,{children:Object(j.jsxs)("div",{className:"app-container",children:[Object(j.jsx)("div",{className:"header",children:Object(j.jsx)(h,{tasks:n,dependencies:a,onTaskChanged:c,onDependenciesChanged:o})}),Object(j.jsxs)("div",{className:"app-content-container",children:[Object(j.jsx)("div",{className:"graph-container",children:Object(j.jsx)(_,{tasks:t,dependencies:r})}),Object(j.jsx)("div",{className:"list-container",children:Object(j.jsx)(x,{tasks:n,dependencies:a,onTaskChanged:c,onDependenciesChanged:o})})]})]})})},M=(t(208),t(209),t(210),t(211),t(212),document.getElementById("root"));Object(a.render)(Object(j.jsx)(K,{}),M)}},[[213,1,2]]]);
//# sourceMappingURL=main.df95837f.chunk.js.map